<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
  <title>WebAR Demo</title>

  <!-- Installable PWA manifest -->
  <link rel="manifest" href="manifest.json">

  <!-- Google’s model-viewer Web Component -->
  <script type="module"
          src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>

  <style>
    html,body{margin:0;height:100%;background:#000;}
    model-viewer{width:100%;height:100vh;}
    #install{position:fixed;bottom:16px;left:50%;transform:translateX(-50%);
             padding:10px 18px;font-size:16px;z-index:1;}
  </style>
</head>
<body>

  <!-- The actual 3-D model + AR button -->
  <model-viewer
      src="https://modelviewer.dev/shared-assets/models/Astronaut.glb"
      ios-src="https://modelviewer.dev/shared-assets/models/Astronaut.usdz"
      ar
      ar-modes="webxr scene-viewer quick-look"
      camera-controls
      auto-rotate
      disable-zoom>
  </model-viewer>

  <!-- Optional “Add to Home Screen” button -->
  <button id="install" hidden>Add to Home Screen</button>

  <script>
    /* ===== PWA install prompt ===== */
    let deferredPrompt;
    const btn = document.getElementById('install');

    window.addEventListener('beforeinstallprompt', e => {
      e.preventDefault();
      deferredPrompt = e;
      btn.hidden = false;
    });

    btn.addEventListener('click', async () => {
      deferredPrompt.prompt();
      await deferredPrompt.userChoice;
      deferredPrompt = null;
      btn.hidden = true;
    });

    /* ===== Service-worker registration ===== */
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('sw.js');
    }
  </script>
</body>
</html>
